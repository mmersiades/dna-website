@layer base, utilities, presentation, scroll-timeline, fallback;

@layer presentation {
    :root {
        --color-text: #240115;
        --footer-height: 5rem;
        --height-header: 6rem;


        --font-size-its: 3rem;
        --font-size-quote: 2rem;
        --padding-left: 4rem;
        --animation-range-1: 125vh 225vh;
        --animation-range-2: 225vh 325vh;
        --animation-range-3: 325vh 425vh;
        --animation-range-4: 425vh 525vh;
        --animation-range-5: 525vh 625vh;
        --animation-range-6: 625vh 725vh;
    }

    .citation {
        text-align: center;
        font-size: clamp(0.6rem, 5vh, 1rem);
        color: var(--color-text);
        text-decoration: none;

        &:hover {
            color: oklch(from var(--color-text) calc(l + 0.2) c h);
        }
    }

    .citation::after {
        content: " â†—";
    }

    .citation-container {
        width: var(--width-opening-quote-container);
        position: fixed;
        left: 50%;
        bottom: 0;
        will-change: transform;
        height: var(--footer-height);
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .its-section {
        position: relative;
        height: 50vh;
    }

    .its-spacer {
        height: 25vh;
    }

    .its-container {
        padding-left: var(--padding-left);

        position: fixed;
        top: var(--height-header);
        left: 0;

        will-change: transform, opacity;

        h3 {
            font-size: var(--font-size-its);
        }
    }

    .its-noun-container {
        margin-left: calc(var(--padding-left) + (var(--font-size-its) * 1.75));

        position: fixed;
        top: var(--height-header);
        left: 0;

        h3 {
            font-size: var(--font-size-its);
        }
    }

    .its-noun {
        color: var(--color-primary);
    }

    @media (max-width: 800px) {
        :root {
            --width-opening-quote-container: 75vw;
            --footer-height: 4rem;

            --font-size-its: 2rem;
            --font-size-quote: 1.5rem;
            --padding-left: 1rem;
        }
    }

    @media (max-width: 576px) {
        :root {
            --width-opening-quote-container: 75vw;
            --footer-height: 3rem;

            --font-size-its: 2rem;
            --font-size-quote: 1.5rem;
            --padding-left: 1rem;
        }
    }

    @media (max-width: 375px) {
        :root {
            --width-opening-quote-container: 80vw;
            --footer-height: 3.5rem;

            --font-size-its: 1.5rem;
            --font-size-quote: 1.2rem;
            --padding-left: 1rem;
        }

        blockquote {
            margin-block-start: 0.5em;
            margin-block-end: 0.5em;
            margin-inline-start: 20px;
            margin-inline-end: 20px;
        }
    }
}

@layer scroll-timeline {
    @supports (animation-timeline: scroll()) {
        /*Hide fallback elements*/
        .fallback-its-container {
            display: none;
        }





        @keyframes slide-right-out {
            0% {
                transform: translate(calc(-100vw - 50%), -50%);
                opacity: 0;
            }
            25% {
                transform: translate(-50%, -50%);
                opacity: 1;
            }
            75% {
                transform: translate(-50%, -50%);
                opacity: 1;
            }
            100% {
                transform: translate(calc(100vw - 50%), -50%);
                opacity: 0;
            }
        }



        @keyframes slide-up {
            0% {
                transform: translateY(100vh);
                opacity: 100;
            }
            4% {
                transform: translateY(0);
                opacity: 100;
            }
            95% {
                transform: translateY(0);
                opacity: 100;
            }
            100% {
                transform: translateY(0);
                opacity: 0;
            }
        }

        @keyframes slide-left-out {
            0% {
                transform: translateX(100vw);
                opacity: 100;
            }
            20% {
                transform: translateX(0);
                opacity: 100;
            }
            80% {
                transform: translateX(0);
                opacity: 100;
            }
            100% {
                transform: translateX(-100vw);
                opacity: 0;
            }
        }

        .its-container {
            animation-name: slide-up;
            animation-timeline: scroll(root block);
            animation-range: 125vh 725vh;
            animation-duration: auto;
            animation-fill-mode: both;
        }

        .its-noun-container {
            animation-name: slide-left-out;
            animation-timeline: scroll(root block);
            animation-duration: auto;
            animation-fill-mode: both;
        }

        .its-section .first {
            animation-name: slide-left-out;
            animation-range: var(--animation-range-1);
        }

        .its-section .second {
            animation-name: slide-left-out;
            animation-range: var(--animation-range-2);
        }

        .its-section .third {
            animation-name: slide-left-out;
            animation-range: var(--animation-range-3);
        }

        .its-section .fourth {
            animation-name: slide-left-out;
            animation-range: var(--animation-range-4);
        }

        .its-section .fifth {
            animation-name: slide-left-out;
            animation-range: var(--animation-range-5);
        }

        .its-section .sixth {
            animation-name: slide-left-out;
            animation-range: var(--animation-range-6);
        }

        .citation-container {
            animation-name: slide-right-out;
            animation-timeline: scroll(root block);
            animation-duration: auto;
            animation-fill-mode: both;
        }

        .citation-section .first {
            animation-name: slide-right-out;
            animation-range: 25vh 125vh;
        }

        .citation-section .second {
            animation-name: slide-right-out;
            animation-range: var(--animation-range-1);
        }

        .citation-section .third {
            animation-name: slide-right-out;
            animation-range: var(--animation-range-2);
        }

        .citation-section .fourth {
            animation-name: slide-right-out;
            animation-range: var(--animation-range-3);
        }

        .citation-section .fifth {
            animation-name: slide-right-out;
            animation-range: var(--animation-range-4);
        }

        .citation-section .sixth {
            animation-name: slide-right-out;
            animation-range: var(--animation-range-5);
        }

        .citation-section .seventh {
            animation-name: slide-right-out;
            animation-range: var(--animation-range-6);
        }
    }
}

@layer fallback {
    /* This will only apply when scroll-driven animations are NOT supported */
    @supports not (animation-timeline: scroll()) {

        /* Make sections flow normally */
        .its-section {
            position: relative;
            height: auto;
            margin-bottom: 4rem;
        }

        /* Remove spacers that were used for animation timing */
        .its-spacer {
            display: none;
        }

        /* Style "It's" section for normal flow */
        .its-container {
            display: none;
        }

        /* Style "its-noun" containers for normal flow */
        .its-noun-container {
            display: none;
        }


        /* Style citation containers for normal flow */
        .citation-container {
            position: relative;
            width: var(--width-opening-quote-container);
            left: auto;
            bottom: auto;
            margin: 1rem auto;
            transform: none;
            height: auto;
        }

        .fallback-its-container {
            position: relative;
            padding-left: var(--padding-left);
            border-top: 1px solid var(--color-secondary);

            h3 {
                font-size: var(--font-size-its);
            }
        }
    }
}